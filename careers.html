<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>职位库 - 大学生岗位胜任力提升平台</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen">
  <main class="max-w-6xl mx-auto p-6">
    <a href="index.html" class="text-sm text-blue-600 hover:underline">← 返回主页</a>

    <h1 class="text-2xl font-semibold mt-4">职位库</h1>
    <p class="text-sm text-slate-500 mt-1">搜索并浏览适合你的实习和全职岗位。</p>

    <div class="mt-6 bg-white rounded-xl border border-slate-200 p-6">
      <div class="flex gap-3 items-center">
        <input id="jobSearch" type="text" placeholder="搜索职位 / 公司 / 地点" class="flex-1 px-4 py-2 rounded-lg border border-slate-200 focus:ring-2 focus:ring-blue-100 outline-none">
        <select id="jobType" class="px-3 py-2 rounded-lg border border-slate-200">
          <option value="all">全部</option>
          <option value="intern">实习</option>
          <option value="full">全职</option>
        </select>
        <button id="searchBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg">搜索</button>
      </div>

      <div id="jobsList" class="mt-6 grid md:grid-cols-2 gap-4"></div>
    </div>
  </main>

  <script>
    const jobs = [
      {id:1,title:'前端实习工程师',company:'某科技有限公司',loc:'上海',type:'intern',salary:'面议',desc:'熟悉 HTML/CSS/JS，掌握 React 加分'},
      {id:2,title:'数据分析实习',company:'数据智能公司',loc:'北京',type:'intern',salary:'3000-5000',desc:'熟悉 Excel / SQL / Python'},
      {id:3,title:'后端开发工程师',company:'云服务厂商',loc:'深圳',type:'full',salary:'15k-25k',desc:'Golang 或 Java，熟悉微服务'},
      {id:4,title:'产品经理',company:'互联网公司',loc:'杭州',type:'full',salary:'12k-20k',desc:'有项目经验，沟通能力强'}
    ];

    function render(list){
      const container = document.getElementById('jobsList');
      container.innerHTML = '';
      if(!list.length){ container.innerHTML = '<p class="text-sm text-slate-500">未找到职位。</p>'; return; }
      const favs = JSON.parse(localStorage.getItem('uni_fav_jobs')||'[]');
      list.forEach(j=>{
        const isFav = favs.includes(j.id);
        const a = document.createElement('div');
        a.className = 'bg-white rounded-xl border border-slate-200 p-4 flex flex-col justify-between';
        a.innerHTML = `
          <div>
            <h3 class="font-semibold text-lg">${j.title}</h3>
            <p class="text-sm text-slate-500 mt-1">${j.company} · ${j.loc} · <span class="text-slate-600">${j.salary}</span></p>
            <p class="text-sm text-slate-500 mt-2 line-clamp-3">${j.desc}</p>
          </div>
          <div class="mt-4 flex items-center justify-between">
            <div class="text-xs text-slate-400">类型：${j.type==='intern'?'实习':'全职'}</div>
            <div class="flex gap-2 items-center">
              <button data-id="${j.id}" class="favBtn text-sm px-3 py-1.5 rounded-lg ${isFav? 'bg-yellow-400 text-white':'border border-slate-200'}">${isFav? '已收藏':'收藏'}</button>
              <button data-id="${j.id}" class="applyBtn bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm">申请</button>
              <button data-id="${j.id}" class="detailBtn border border-slate-200 px-3 py-1.5 rounded-lg text-sm">查看详情</button>
            </div>
          </div>
        `;
        container.appendChild(a);
      });

      document.querySelectorAll('.favBtn').forEach(btn=>{
        btn.addEventListener('click', e=>{
          const id = parseInt(btn.getAttribute('data-id'),10);
          let favs = JSON.parse(localStorage.getItem('uni_fav_jobs')||'[]');
          if(favs.includes(id)){
            favs = favs.filter(x=>x!==id);
            localStorage.setItem('uni_fav_jobs', JSON.stringify(favs));
            btn.classList.remove('bg-yellow-400','text-white');
            btn.classList.add('border');
            btn.textContent = '收藏';
          } else {
            favs.push(id);
            localStorage.setItem('uni_fav_jobs', JSON.stringify(favs));
            btn.classList.add('bg-yellow-400','text-white');
            btn.classList.remove('border');
            btn.textContent = '已收藏';
          }
        });
      });

      document.querySelectorAll('.applyBtn').forEach(btn=>{
        btn.addEventListener('click', e=>{
          const isAuth = sessionStorage.getItem('uni_auth')==='true' || localStorage.getItem('uni_auth')==='true';
          if(!isAuth){
            const returnTo = encodeURIComponent(location.href);
            location.href = 'login.html?return=' + returnTo;
            return;
          }
          alert('已成功申请（模拟）');
        });
      });

      document.querySelectorAll('.detailBtn').forEach(btn=>{
        btn.addEventListener('click', e=>{
          const id = btn.getAttribute('data-id');
          alert('职位详情占位：ID ' + id);
        });
      });
    }

    function filterJobs(){
      const q = document.getElementById('jobSearch').value.trim().toLowerCase();
      const type = document.getElementById('jobType').value;
      const filtered = jobs.filter(j=>{
        if(type!=='all' && j.type!==type) return false;
        if(!q) return true;
        return (j.title+j.company+j.loc+j.desc).toLowerCase().includes(q);
      });
      render(filtered);
    }

    document.getElementById('searchBtn').addEventListener('click', filterJobs);
    document.getElementById('jobSearch').addEventListener('keydown', e=>{ if(e.key==='Enter') filterJobs(); });

    // initial render
    render(jobs);
  </script>
</body>
</html>
