<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>能力测评 - 大学生岗位胜任力提升平台</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen">
  <main class="max-w-4xl mx-auto p-6">
    <a href="index.html" class="text-sm text-blue-600 hover:underline">← 返回主页</a>
    <div class="mt-6 bg-white rounded-xl border border-slate-200 p-6">
      <h1 class="text-2xl font-semibold">能力测评</h1>
      <p class="text-sm text-slate-500 mt-2">开始测评以获得技能报告与课程建议。</p>

      <!-- Enhanced assessment panel with tech-themed visuals -->
      <div class="mt-6 relative overflow-hidden">
        <div class="absolute inset-0 pointer-events-none opacity-30">
          <svg viewBox="0 0 800 200" class="w-full h-full" preserveAspectRatio="none">
            <defs>
              <linearGradient id="g1" x1="0" x2="1">
                <stop offset="0%" stop-color="#60a5fa" />
                <stop offset="50%" stop-color="#7dd3fc" />
                <stop offset="100%" stop-color="#a78bfa" />
              </linearGradient>
            </defs>
            <rect x="0" y="0" width="800" height="200" fill="url(#g1)"></rect>
            <g fill="none" stroke="#ffffff" stroke-opacity="0.12">
              <circle cx="100" cy="100" r="80"></circle>
              <circle cx="300" cy="50" r="50"></circle>
              <circle cx="600" cy="120" r="70"></circle>
            </g>
          </svg>
        </div>

        <div class="relative z-10 bg-white rounded-xl border border-slate-200 p-6 shadow-md">
          <div class="flex items-start gap-6">
            <div class="grow">
              <h2 class="text-2xl font-semibold">智能能力测评</h2>
              <p class="text-sm text-slate-500 mt-2">我们的 AI 测评基于岗位能力框架分析你的技能缺口，测评结束后将生成个性化学习路径与推荐课程。</p>

              <div id="statusArea" class="mt-4"></div>

              <div class="mt-5 flex items-center gap-3">
                <button id="startBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow">开始测评</button>
                <button id="viewReport" class="bg-white border border-slate-200 px-4 py-2 rounded-lg">查看历史报告</button>
                <a href="#" class="ml-4 text-xs text-slate-400">测评说明</a>
              </div>
            </div>

            <aside class="w-48 hidden sm:block">
              <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                <h3 class="text-sm font-semibold text-slate-800">测评流程</h3>
                <ol class="mt-3 text-xs text-slate-600 space-y-2">
                  <li>1）基础能力诊断（15题）</li>
                  <li>2）岗位情景题（10题）</li>
                  <li>3）个性化分析（自动生成）</li>
                </ol>
              </div>

              <div class="mt-4 p-3 rounded-lg bg-white border border-slate-100 text-center">
                <div class="text-xs text-slate-500">模型</div>
                <div class="text-lg font-bold text-blue-600">AI-Profiler</div>
              </div>
            </aside>
          </div>

          <div class="mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4">
            <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
              <div class="text-xs text-slate-500">覆盖维度</div>
              <div class="text-lg font-semibold text-slate-900">核心能力 · 岗位感知</div>
            </div>
            <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
              <div class="text-xs text-slate-500">耗时</div>
              <div class="text-lg font-semibold text-slate-900">约 10-20 分钟</div>
            </div>
            <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
              <div class="text-xs text-slate-500">报告</div>
              <div class="text-lg font-semibold text-slate-900">PDF / 在线报告</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    const reportKey = 'uni_assessment_result';
    const statusArea = document.getElementById('statusArea');

    function renderStatus(){
      const r = localStorage.getItem(reportKey);
      if(r){
        const obj = JSON.parse(r);
        statusArea.innerHTML = `<div class="p-4 bg-green-50 border border-green-100 rounded-lg">
          <div class="font-medium">上次测评成绩：${obj.score} 分</div>
          <div class="text-sm text-slate-500 mt-1">完成于：${new Date(obj.t).toLocaleString()}</div>
          <div class="text-sm text-slate-600 mt-2">建议：${obj.suggestion}</div>
        </div>`;
      } else {
        statusArea.innerHTML = '<p class="text-sm text-slate-500">您尚未参加测评。</p>';
      }
    }

    document.getElementById('startBtn').addEventListener('click', ()=>{
      const isAuth = sessionStorage.getItem('uni_auth')==='true' || localStorage.getItem('uni_auth')==='true';
      if(!isAuth){
        const returnTo = encodeURIComponent(location.href);
        location.href = 'login.html?return=' + returnTo;
        return;
      }
      // simulate test
      const btn = document.getElementById('startBtn');
      btn.disabled = true; btn.textContent = '测评进行中...';
      setTimeout(()=>{
        const score = Math.floor(Math.random()*41)+60; // 60-100
        const suggestion = score >= 85 ? '继续保持，挑战高阶课程' : score >=70 ? '建议补强核心技能，选修相关课程' : '建议从基础课程开始学习并参加训练营';
        const data = {score, suggestion, t: Date.now()};
        localStorage.setItem(reportKey, JSON.stringify(data));
        btn.disabled = false; btn.textContent = '开始测评';
        renderStatus();
        alert('测评完成，得分：' + score + ' 分（模拟）');
      }, 1500);
    });

    document.getElementById('viewReport').addEventListener('click', ()=>{
      const r = localStorage.getItem(reportKey);
      if(!r){ alert('暂无历史报告。'); return; }
      const obj = JSON.parse(r);
      alert('历史报告（模拟）\n得分：' + obj.score + '\n建议：' + obj.suggestion + '\n完成时间：' + new Date(obj.t).toLocaleString());
    });

    renderStatus();
  </script>
</body>
</html>
